# EcoCharge CTF - Network Topology (Short Version)

## Infrastructure Overview

**Version:** 4.0 | **Zones:** 5 | **VMs:** 9

---

## Network Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              NETWORK TOPOLOGY                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ğŸŒ INTERNET    â”‚
    â”‚  192.168.125.0  â”‚
    â”‚                 â”‚
    â”‚ ğŸ‘¤ Attacker     â”‚
    â”‚ .100 (Kali)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ HTTP/HTTPS
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ğŸŒ FRONTEND    â”‚
    â”‚  192.168.250.0  â”‚
    â”‚                 â”‚
    â”‚ ğŸ–¥ï¸ Web Server   â”‚
    â”‚ .50 (Next.js)   â”‚
    â”‚ [CWE-78]        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ SSH + API
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                    ğŸ›¡ï¸ DMZ                           â”‚
    â”‚                 192.168.100.0                        â”‚
    â”‚                                                      â”‚
    â”‚  âš™ï¸ API Gateway    ğŸ“Š Grafana     ğŸ”‘ Jump Host      â”‚
    â”‚  .20:8080         .30:3000       .40 (multi-homed)  â”‚
    â”‚                                   â”‚                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚ SSH
                                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                  ğŸ—„ï¸ INTERNAL                        â”‚
    â”‚                 192.168.20.0                         â”‚
    â”‚                                                      â”‚
    â”‚              ğŸ’¾ CitrineOS CSMS                       â”‚
    â”‚              .20 (Next.js 15.1.2)                    â”‚
    â”‚              [CVE-2025-55182]                        â”‚
    â”‚              Hasura + PostgreSQL                     â”‚
    â”‚                      â”‚                               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ OCPP WebSocket
                           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                    âš¡ OT NETWORK                     â”‚
    â”‚                    172.16.0.0                        â”‚
    â”‚                                                      â”‚
    â”‚        ğŸ”Œ CP001 (.40)        ğŸ”Œ CP002 (.60)          â”‚
    â”‚        OCPP 1.6-J            OCPP 2.0.1              â”‚
    â”‚                                                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Zone Summary

| Zone | CIDR | Components | Vulnerabilities |
|------|------|------------|-----------------|
| **Internet** | 192.168.125.0/24 | Kali Linux | - |
| **Frontend** | 192.168.250.0/24 | Web Server | CWE-78 Command Injection |
| **DMZ** | 192.168.100.0/24 | API GW, Grafana, Jump Host | Info Disclosure, Default Creds |
| **Internal** | 192.168.20.0/24 | CitrineOS CSMS | CVE-2025-55182, Weak Secrets |
| **OT** | 172.16.0.0/24 | EVerest Chargers | - |

---

## Key Components

### Web Server (192.168.250.50)
- **Stack:** Next.js 14.2.5 / React 18.3.1
- **Vulnerability:** Command Injection in `/api/qr`
- **FLAGS:** #1, #2, #3

### Jump Host (192.168.100.40)
- **Role:** Multi-homed bastion (DMZ/Internal/OT)
- **Access:** SSH with stolen key from Web Server
- **FLAG:** #5

### CitrineOS CSMS (192.168.20.20)
- **Stack:** Next.js 15.1.2 / React 19.x / Hasura / PostgreSQL
- **Vulnerability:** CVE-2025-55182 (React2Shell RCE)
- **FLAGS:** #7, #8, #9

---

## Attack Path

```
Attacker â†’ Web Server â†’ Jump Host â†’ CSMS â†’ Database
           (Cmd Inj)    (SSH key)   (CVE-2025-55182)
```

---

**Version:** 4.0 | **Last Updated:** February 2025
